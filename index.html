<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penghitung Poin Remi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .slide-up { animation: slideUp 0.3s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-800 min-h-screen">
    <!-- Header -->
    <div class="bg-white/10 backdrop-blur-md border-b border-white/20">
        <div class="max-w-6xl mx-auto px-4 py-6">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-3xl font-bold text-white flex items-center gap-3">
                        🃏 Penghitung Poin Remi
                    </h1>
                    <p class="text-white/60 text-sm mt-1">BY <span class="text-white font-medium">Irsan R</span></p>
                </div>
                <div class="flex gap-3 flex-wrap">
                    <button onclick="showAddPlayerModal()" class="bg-emerald-500 hover:bg-emerald-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                        + Tambah Pemain
                    </button>
                    <button onclick="exportData()" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                        📤 Ekspor Data
                    </button>
                    <button onclick="showImportModal()" class="bg-purple-500 hover:bg-purple-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                        📥 Impor Data
                    </button>
                    <button onclick="showResetModal()" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                        🔄 Reset Permainan
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="max-w-6xl mx-auto px-4 py-8">
        <div class="grid lg:grid-cols-3 gap-8">
            <!-- Daftar Pemain -->
            <div class="lg:col-span-2">
                <div class="bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 p-6 shadow-2xl">
                    <h2 class="text-2xl font-semibold text-white mb-6 flex items-center gap-2">
                        👥 Daftar Pemain
                    </h2>
                    <div id="playersList" class="space-y-4">
                        <!-- Pemain akan ditambahkan di sini -->
                    </div>
                    <div id="emptyState" class="text-center py-12 text-white/60">
                        <div class="text-6xl mb-4">🎮</div>
                        <p class="text-lg">Belum ada pemain. Tambahkan pemain untuk memulai!</p>
                    </div>
                </div>
            </div>

            <!-- Riwayat Poin -->
            <div class="lg:col-span-1">
                <div class="bg-white/10 backdrop-blur-md rounded-2xl border border-white/20 p-6 shadow-2xl">
                    <h2 class="text-2xl font-semibold text-white mb-6 flex items-center gap-2">
                        📊 Riwayat Poin
                    </h2>
                    <div id="historyList" class="space-y-3 max-h-96 overflow-y-auto">
                        <div class="text-center py-8 text-white/60">
                            <div class="text-4xl mb-2">📝</div>
                            <p>Belum ada riwayat</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Tambah Pemain -->
    <div id="addPlayerModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl slide-up">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Tambah Pemain Baru</h3>
            <input type="text" id="playerNameInput" placeholder="Nama pemain..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none text-lg">
            <div class="flex gap-3 mt-6">
                <button onclick="addPlayer()" class="flex-1 bg-indigo-500 hover:bg-indigo-600 text-white py-3 rounded-lg font-medium transition-colors">
                    Tambah
                </button>
                <button onclick="hideAddPlayerModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 rounded-lg font-medium transition-colors">
                    Batal
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Reset -->
    <div id="resetModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl slide-up">
            <div class="text-center">
                <div class="text-6xl mb-4">⚠️</div>
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Reset Permainan?</h3>
                <p class="text-gray-600 mb-6">Semua poin pemain akan direset ke 0 dan riwayat akan dihapus. Tindakan ini tidak dapat dibatalkan.</p>
                <div class="flex gap-3">
                    <button onclick="resetGame()" class="flex-1 bg-red-500 hover:bg-red-600 text-white py-3 rounded-lg font-medium transition-colors">
                        Ya, Reset
                    </button>
                    <button onclick="hideResetModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 rounded-lg font-medium transition-colors">
                        Batal
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Edit Pemain -->
    <div id="editPlayerModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl slide-up">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Edit Nama Pemain</h3>
            <input type="text" id="editPlayerNameInput" placeholder="Nama pemain..." class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none text-lg">
            <div class="flex gap-3 mt-6">
                <button onclick="savePlayerEdit()" class="flex-1 bg-indigo-500 hover:bg-indigo-600 text-white py-3 rounded-lg font-medium transition-colors">
                    Simpan
                </button>
                <button onclick="hideEditPlayerModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 rounded-lg font-medium transition-colors">
                    Batal
                </button>
            </div>
        </div>
    </div>



    <!-- Modal Impor Data -->
    <div id="importModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl slide-up">
            <h3 class="text-2xl font-bold text-gray-800 mb-6">Impor Data</h3>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-medium mb-2">Pilih file data (.json):</label>
                <input type="file" id="importFileInput" accept=".json" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent outline-none">
            </div>
            <div class="flex gap-3">
                <button onclick="importData()" class="flex-1 bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-lg font-medium transition-colors">
                    Impor
                </button>
                <button onclick="hideImportModal()" class="flex-1 bg-gray-300 hover:bg-gray-400 text-gray-700 py-3 rounded-lg font-medium transition-colors">
                    Batal
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Riwayat Pemain -->
    <div id="playerHistoryModal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-lg w-full mx-4 shadow-2xl slide-up max-h-[80vh] overflow-hidden flex flex-col">
            <div class="flex items-center justify-between mb-6">
                <h3 id="playerHistoryTitle" class="text-2xl font-bold text-gray-800">Riwayat Pemain</h3>
                <button onclick="hidePlayerHistoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">×</button>
            </div>
            <div id="playerHistoryContent" class="flex-1 overflow-y-auto space-y-3">
                <!-- Riwayat pemain akan ditampilkan di sini -->
            </div>
        </div>
    </div>



    <script>
        let players = [];
        let history = [];
        let editingPlayerId = null;

        // Fungsi untuk menyimpan data ke localStorage
        function saveToLocalStorage() {
            const data = {
                players: players,
                history: history,
                lastUpdated: new Date().toISOString()
            };
            localStorage.setItem('remiGameData', JSON.stringify(data));
        }

        // Fungsi untuk memuat data dari localStorage
        function loadFromLocalStorage() {
            const savedData = localStorage.getItem('remiGameData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    players = data.players || [];
                    history = data.history || [];
                    renderPlayers();
                    renderHistory();
                } catch (e) {
                    console.error('Error loading data from localStorage:', e);
                }
            }
        }

        // Fungsi untuk menampilkan/menyembunyikan modal
        function showAddPlayerModal() {
            document.getElementById('addPlayerModal').classList.remove('hidden');
            document.getElementById('addPlayerModal').classList.add('flex');
            document.getElementById('playerNameInput').focus();
        }

        function hideAddPlayerModal() {
            document.getElementById('addPlayerModal').classList.add('hidden');
            document.getElementById('addPlayerModal').classList.remove('flex');
            document.getElementById('playerNameInput').value = '';
        }

        function showResetModal() {
            document.getElementById('resetModal').classList.remove('hidden');
            document.getElementById('resetModal').classList.add('flex');
        }

        function hideResetModal() {
            document.getElementById('resetModal').classList.add('hidden');
            document.getElementById('resetModal').classList.remove('flex');
        }

        function showEditPlayerModal(playerId) {
            editingPlayerId = playerId;
            const player = players.find(p => p.id === playerId);
            document.getElementById('editPlayerNameInput').value = player.name;
            document.getElementById('editPlayerModal').classList.remove('hidden');
            document.getElementById('editPlayerModal').classList.add('flex');
            document.getElementById('editPlayerNameInput').focus();
        }

        function hideEditPlayerModal() {
            document.getElementById('editPlayerModal').classList.add('hidden');
            document.getElementById('editPlayerModal').classList.remove('flex');
            editingPlayerId = null;
        }



        function showImportModal() {
            document.getElementById('importModal').classList.remove('hidden');
            document.getElementById('importModal').classList.add('flex');
        }

        function hideImportModal() {
            document.getElementById('importModal').classList.add('hidden');
            document.getElementById('importModal').classList.remove('flex');
            document.getElementById('importFileInput').value = '';
        }

        function showPlayerHistory(playerId) {
            const player = players.find(p => p.id === playerId);
            const playerHistory = history.filter(h => h.text.includes(player.name));
            
            document.getElementById('playerHistoryTitle').textContent = `Riwayat - ${player.name}`;
            
            const content = document.getElementById('playerHistoryContent');
            if (playerHistory.length === 0) {
                content.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <div class="text-4xl mb-2">📝</div>
                        <p>Belum ada riwayat untuk ${player.name}</p>
                    </div>
                `;
            } else {
                content.innerHTML = playerHistory.map(item => `
                    <div class="bg-gray-50 rounded-lg p-4 border border-gray-200">
                        <div class="text-gray-800 text-sm">${item.text}</div>
                        <div class="text-gray-500 text-xs mt-2">${item.time}</div>
                    </div>
                `).join('');
            }
            
            document.getElementById('playerHistoryModal').classList.remove('hidden');
            document.getElementById('playerHistoryModal').classList.add('flex');
        }

        function hidePlayerHistoryModal() {
            document.getElementById('playerHistoryModal').classList.add('hidden');
            document.getElementById('playerHistoryModal').classList.remove('flex');
        }

        // Fungsi untuk ekspor data
        function exportData() {
            const data = {
                players: players,
                history: history,
                exportDate: new Date().toISOString(),
                version: '1.0'
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `remi-game-data-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
        }

        // Fungsi untuk impor data
        function importData() {
            const fileInput = document.getElementById('importFileInput');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Pilih file terlebih dahulu!');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    if (!data.players || !Array.isArray(data.players)) {
                        throw new Error('Format file tidak valid');
                    }
                    
                    if (confirm('Impor data akan mengganti semua data yang ada. Lanjutkan?')) {
                        players = data.players;
                        history = data.history || [];
                        
                        saveToLocalStorage();
                        renderPlayers();
                        renderHistory();
                        hideImportModal();
                    }
                } catch (error) {
                    alert('File tidak valid atau rusak!');
                }
            };
            reader.readAsText(file);
        }

        // Fungsi untuk menambah pemain
        function addPlayer() {
            const nameInput = document.getElementById('playerNameInput');
            const name = nameInput.value.trim();
            
            if (name === '') {
                alert('Nama pemain tidak boleh kosong!');
                return;
            }

            if (players.some(p => p.name.toLowerCase() === name.toLowerCase())) {
                alert('Nama pemain sudah ada!');
                return;
            }

            const newPlayer = {
                id: Date.now(),
                name: name,
                score: 0
            };

            players.push(newPlayer);
            saveToLocalStorage();
            renderPlayers();
            hideAddPlayerModal();
        }

        // Fungsi untuk mengedit nama pemain
        function savePlayerEdit() {
            const nameInput = document.getElementById('editPlayerNameInput');
            const newName = nameInput.value.trim();
            
            if (newName === '') {
                alert('Nama pemain tidak boleh kosong!');
                return;
            }

            if (players.some(p => p.name.toLowerCase() === newName.toLowerCase() && p.id !== editingPlayerId)) {
                alert('Nama pemain sudah ada!');
                return;
            }

            const player = players.find(p => p.id === editingPlayerId);
            const oldName = player.name;
            player.name = newName;
            
            saveToLocalStorage();
            renderPlayers();
            hideEditPlayerModal();
        }

        // Fungsi untuk menghapus pemain
        function deletePlayer(playerId) {
            if (confirm('Yakin ingin menghapus pemain ini?')) {
                const player = players.find(p => p.id === playerId);
                players = players.filter(p => p.id !== playerId);
                saveToLocalStorage();
                renderPlayers();
            }
        }

        // Fungsi untuk mengubah poin
        function changeScore(playerId, change) {
            const player = players.find(p => p.id === playerId);
            player.score += change;
            
            const changeText = change > 0 ? `+${change}` : `${change}`;
            const emoji = change > 0 ? '⬆️' : '⬇️';
            addToHistory(`${emoji} ${player.name}: ${changeText} poin (Total: ${player.score})`);
            
            saveToLocalStorage();
            renderPlayers();
        }

        // Fungsi untuk menambah poin dengan input inline
        function addPoints(playerId) {
            const pointInput = document.getElementById(`pointInput_${playerId}`);
            const points = parseInt(pointInput.value);
            
            if (isNaN(points) || points <= 0) {
                alert('Masukkan jumlah poin yang valid (lebih dari 0)!');
                return;
            }
            
            changeScore(playerId, points);
            pointInput.value = '';
        }

        // Fungsi untuk mengurangi poin dengan input inline
        function subtractPoints(playerId) {
            const pointInput = document.getElementById(`pointInput_${playerId}`);
            const points = parseInt(pointInput.value);
            
            if (isNaN(points) || points <= 0) {
                alert('Masukkan jumlah poin yang valid (lebih dari 0)!');
                return;
            }
            
            changeScore(playerId, -points);
            pointInput.value = '';
        }

        // Fungsi untuk menambah ke riwayat
        function addToHistory(text) {
            const now = new Date();
            const time = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit' });
            history.unshift({ text, time });
            renderHistory();
        }

        // Fungsi untuk reset permainan
        function resetGame() {
            players.forEach(player => player.score = 0);
            history = [];
            saveToLocalStorage();
            renderPlayers();
            renderHistory();
            hideResetModal();
        }

        // Fungsi untuk render pemain
        function renderPlayers() {
            const playersList = document.getElementById('playersList');
            const emptyState = document.getElementById('emptyState');
            
            if (players.length === 0) {
                playersList.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            
            // Urutkan pemain berdasarkan skor tertinggi
            const sortedPlayers = [...players].sort((a, b) => b.score - a.score);
            
            playersList.innerHTML = sortedPlayers.map((player, index) => {
                const rankEmoji = index === 0 ? '🥇' : index === 1 ? '🥈' : index === 2 ? '🥉' : '👤';
                return `
                    <div class="bg-white/20 backdrop-blur-sm rounded-xl p-6 border border-white/30 fade-in">
                        <div class="flex items-center justify-between mb-4">
                            <div class="flex items-center gap-3">
                                <span class="text-2xl">${rankEmoji}</span>
                                <div>
                                    <h3 class="text-xl font-semibold text-white">${player.name}</h3>
                                    <p class="text-white/70">Peringkat ${index + 1}</p>
                                </div>
                            </div>
                            <div class="flex items-center gap-3">
                                <button onclick="showPlayerHistory(${player.id})" class="text-white/70 hover:text-white transition-colors p-2" title="Lihat Riwayat">
                                    📊
                                </button>
                                <button onclick="showEditPlayerModal(${player.id})" class="text-white/70 hover:text-white transition-colors p-2" title="Edit Nama">
                                    ✏️
                                </button>
                                <button onclick="deletePlayer(${player.id})" class="text-red-400 hover:text-red-300 transition-colors p-2" title="Hapus Pemain">
                                    🗑️
                                </button>
                            </div>
                        </div>
                        
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-3">
                                <button onclick="subtractPoints(${player.id})" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                                    - Kurang
                                </button>
                                <input type="number" id="pointInput_${player.id}" placeholder="0" min="1" class="w-20 px-3 py-2 border border-white/30 rounded-lg bg-white/20 text-white text-center placeholder-white/50 focus:ring-2 focus:ring-white/50 focus:border-transparent outline-none">
                                <button onclick="addPoints(${player.id})" class="bg-emerald-500 hover:bg-emerald-600 text-white px-4 py-2 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl">
                                    + Tambah
                                </button>
                            </div>
                            
                            <div class="text-center bg-white/10 rounded-xl p-4 min-w-[120px]">
                                <div class="text-6xl font-bold text-white mb-1">${player.score}</div>
                                <div class="text-white/70 text-base font-medium">POIN</div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Fungsi untuk render riwayat
        function renderHistory() {
            const historyList = document.getElementById('historyList');
            
            if (history.length === 0) {
                historyList.innerHTML = `
                    <div class="text-center py-8 text-white/60">
                        <div class="text-4xl mb-2">📝</div>
                        <p>Belum ada riwayat</p>
                    </div>
                `;
                return;
            }

            historyList.innerHTML = history.map(item => `
                <div class="bg-white/10 rounded-lg p-3 border border-white/20 fade-in">
                    <div class="text-white/90 text-sm">${item.text}</div>
                    <div class="text-white/50 text-xs mt-1">${item.time}</div>
                </div>
            `).join('');
        }

        // Event listener untuk Enter key
        document.getElementById('playerNameInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                addPlayer();
            }
        });

        document.getElementById('editPlayerNameInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                savePlayerEdit();
            }
        });



        // Tutup modal saat klik di luar
        document.getElementById('addPlayerModal').addEventListener('click', function(e) {
            if (e.target === this) hideAddPlayerModal();
        });

        document.getElementById('resetModal').addEventListener('click', function(e) {
            if (e.target === this) hideResetModal();
        });

        document.getElementById('editPlayerModal').addEventListener('click', function(e) {
            if (e.target === this) hideEditPlayerModal();
        });



        document.getElementById('importModal').addEventListener('click', function(e) {
            if (e.target === this) hideImportModal();
        });

        document.getElementById('playerHistoryModal').addEventListener('click', function(e) {
            if (e.target === this) hidePlayerHistoryModal();
        });

        // Inisialisasi - muat data dari localStorage
        loadFromLocalStorage();
        renderPlayers();
        renderHistory();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'974466ae07cb7b39',t:'MTc1NjA1NDc3Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
